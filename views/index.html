<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Movie - Binge+ Admin Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link href="/css/styles.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
</head>
<body>
    <!-- Animated Background Elements -->
    <div class="bg-elements">
        <div class="bg-circle circle-1"></div>
        <div class="bg-circle circle-2"></div>
        <div class="bg-circle circle-3"></div>
    </div>
    
    <div class="container">
        <div class="back-link animate__animated animate__fadeInLeft">
            <a href="http://34.136.40.60:3001" class="link-primary">
                <i class="ri-arrow-left-line"></i>
                Back to Home Page
            </a>
        </div>

        <form id="movieForm">
            <div class="card">
                <div class="card-header">
                    <h1 class="card-title">Add New Movie</h1>
                    <p class="card-description">Enter the details for the new movie</p>
                </div>
                
                <div class="card-content">
                    <div class="section">
                        <h3 class="section-title">Movie Details</h3>
                        <div class="separator"></div>

                        <div class="form-group">
                            <label for="Title">Title</label>
                            <input type="text" id="Title" name="Title" class="input-field" required>
                        </div>

                        <div class="form-group">
                            <label for="Details">Details</label>
                            <input type="text" id="Details" name="Details" class="input-field" required placeholder="e.g. 720p | 1080p">
                        </div>

                        <div class="form-group">
                            <label for="Description">Description</label>
                            <textarea id="Description" name="Description" class="input-field" required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="Rating">Rating</label>
                            <input type="text" id="Rating" name="Rating" class="input-field" required placeholder="e.g. 7.5/10">
                        </div>

                        <div class="form-group">
                            <label for="Image">Image URL</label>
                            <input type="url" id="Image" name="Image" class="input-field" required>
                        </div>

                        <div class="form-group">
                            <label for="Link">Link</label>
                            <input type="text" id="Link" name="Link" class="input-field" required>
                        </div>

                        <div class="form-group">
                            <label for="Visit_Movie">Visit Movie Link</label>
                            <input type="url" id="Visit_Movie" name="Visit_Movie" class="input-field" required>
                        </div>

                        <div class="form-group">
                            <label for="Trailer">Trailer URL</label>
                            <input type="url" id="Trailer" name="Trailer" class="input-field" required>
                        </div>

                        <div class="form-group">
                            <label for="ReleaseDate">Release Date</label>
                            <input type="text" id="ReleaseDate" name="ReleaseDate" class="input-field" required placeholder="e.g. 11-08+2023">
                        </div>

                        <div class="form-group">
                            <label for="Genre">Genre</label>
                            <input type="text" id="Genre" name="Genre" class="input-field" required>
                        </div>

                        <div class="form-group">
                            <label for="Director">Director</label>
                            <input type="text" id="Director" name="Director" class="input-field" required>
                        </div>

                        <!-- Cast Members -->
                        <div class="section">
                            <div class="section-header">
                                <h3 class="section-title">Cast Members</h3>
                                <button type="button" class="button-outline" id="addCastMember">
                                    <i class="ri-add-circle-line"></i>
                                    Add Cast Member
                                </button>
                            </div>
                            <div class="separator"></div>

                            <div id="castContainer">
                                <div class="cast-member">
                                    <input type="text" name="Cast[]" placeholder="Actor name" class="input-field" required>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card-footer">
                    <button type="button" class="button-secondary">Cancel</button>
                    <button type="submit" class="button-primary">
                        <span class="button-text">Save Movie</span>
                        <i class="ri-save-line"></i>
                    </button>
                </div>
            </div>
        </form>
    </div>

    <script src="/js/scripts.js"></script>
    <script src="/js/movies.js"></script>
    <script>
    // Add Cast Member Functionality
    document.getElementById('addCastMember').addEventListener('click', function() {
        const castContainer = document.getElementById('castContainer');
        const newCastMember = document.createElement('div');
        newCastMember.classList.add('cast-member');
        newCastMember.innerHTML = `
            <input type="text" name="Cast[]" placeholder="Actor name" class="input-field" required>
            <button type="button" class="remove-cast-btn">Remove</button>
        `;
        
        // Add remove functionality to the new cast member
        newCastMember.querySelector('.remove-cast-btn').addEventListener('click', function() {
            castContainer.removeChild(newCastMember);
        });
        
        castContainer.appendChild(newCastMember);
    });

    // Form Submission
    document.getElementById('movieForm').addEventListener('submit', function(event) {
        event.preventDefault();

        // Collect form data
        const formData = new FormData(event.target);
        
        // Prepare Cast array
        const castMembers = Array.from(document.querySelectorAll('input[name="Cast[]"]'))
            .map(input => input.value.trim())
            .filter(name => name !== '');

        // Prepare data object with ONLY the specified fields
        const data = {
            Title: formData.get('Title'),
            Details: formData.get('Details'),
            Description: formData.get('Description'),
            Rating: formData.get('Rating'),
            Image: formData.get('Image'),
            Link: formData.get('Link'),
            Visit_Movie: formData.get('Visit_Movie'),
            Trailer: formData.get('Trailer'),
            ReleaseDate: formData.get('ReleaseDate'),
            Genre: formData.get('Genre'),
            Director: formData.get('Director'),
            Cast: castMembers
        };

        // Send data to server
        fetch('/movies', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(result => {
            alert('Movie added successfully!');
            event.target.reset(); // Reset form
            document.getElementById('castContainer').innerHTML = `
                <div class="cast-member">
                    <input type="text" name="Cast[]" placeholder="Actor name" class="input-field">
                </div>
            `; // Reset cast container
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Failed to add movie. Please try again.');
        });
    });
    </script>
</body>
</html> 